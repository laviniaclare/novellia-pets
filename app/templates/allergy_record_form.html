{% extends 'base.html' %}

{% block title %}{% if allergy %}Edit{% else %}Add{% endif %} allergy record for {{ pet.name }}{% endblock %}

{% block content %}
<header style="position: relative;">
    <h1 style="margin: 0;">{% if allergy %}Edit{% else %}Add{% endif %} Allergy Record</h1>
    <a href="{{ url_for('main.show_pet_profile', pet_id=pet.id) }}"
        style="position: absolute; right: 0; top: 0; padding: 0.5rem; text-decoration: none;">{{ pet.name }}</a>
</header>

{% if error %}
<p style="color: red">{{ error }}</p>
{% endif %}

<form method="post" action="{% if allergy %}{{ url_for('main.edit_allergy_record', pet_id=pet.id, allergy_id=allergy.id) }}{% else %}{{ url_for('main.create_allergy_record', pet_id=pet.id) }}{% endif %}">
    <div>
        <label for="allergy_name">Allergy Name</label>
        <input id="allergy_name" name="allergy_name" value="{{ allergy.allergy_name if allergy else '' }}" required />
    </div>
    <div>
        <label for="reactions">Reactions</label>
        <input id="reactions" name="reactions" value="{{ allergy.reactions if allergy else '' }}" required />
    </div>

    <select id="severity-select" name="severity">
        <option value="">-- choose a severity --</option>
        {% for member in allergySeverity %}
        <option value="{{ member.name }}" {% if allergy and allergy.severity and member == allergy.severity %}selected{% endif %}>{{ member.value }}</option>
        {% endfor %}
    </select>

    <div style="margin-top:1rem;">
        <button type="submit">{% if allergy %}Save{% else %}Add{% endif %}</button>
        <a href="{{ url_for('main.show_pet_profile', pet_id=pet.id) }}"><button type="button">Cancel</button></a>
    </div>
</form>
{% endblock %}
